CREATE DATABASE helpIT;


CREATE TABLE IF NOT EXISTS users (user_id BIGINT PRIMARY KEY auto_increment, username varchar(255) NOT NULL UNIQUE, email varchar(255) NOT NULL UNIQUE, password varchar(255) NOT NULL, active int NOT NULL,created_at timestamp NOT NULL DEFAULT current_timestamp );
CREATE TABLE IF NOT EXISTS roles (role_id INT PRIMARY KEY auto_increment, role varchar(255) NOT NULL UNIQUE);
CREATE TABLE IF NOT EXISTS foundations(foundation_id BIGINT AUTO_INCREMENT PRIMARY KEY,  image varbinary(8000), foundation_name VARCHAR(255), foundation_owner_name VARCHAR(255), foundation_owner_surname VARCHAR(255));
CREATE TABLE IF NOT EXISTS volunteers(volunteer_id BIGINT AUTO_INCREMENT PRIMARY KEY, image varbinary(8000), volunteer_name VARCHAR(255), volunteer_surname VARCHAR(255));
CREATE TABLE IF NOT EXISTS types(type_id INT AUTO_INCREMENT PRIMARY KEY , type_name VARCHAR(255) NOT NULL);
CREATE TABLE IF NOT EXISTS foundation_types(foundation_id BIGINT REFERENCES users(user_id), type_id INT REFERENCES types(type_id), CONSTRAINT PRIMARY KEY(foundation_id,type_id));
CREATE TABLE IF NOT EXISTS addresses(address_id BIGINT AUTO_INCREMENT PRIMARY KEY, address_city VARCHAR(255), address_street VARCHAR(255), address_postcode VARCHAR(255), address_number_of_home VARCHAR(16), address_number_of_flat INT);

CREATE TABLE IF NOT EXISTS user_address(user_id BIGINT REFERENCES users(user_id), address_id BIGINT REFERENCES addresses(address_id), CONSTRAINT PRIMARY KEY(user_id,address_id));
CREATE TABLE IF NOT EXISTS user_volunteer( user_id BIGINT REFERENCES users(user_id),volunteer_id BIGINT REFERENCES volunteers(volunteer_id), CONSTRAINT PRIMARY KEY (volunteer_id, user_id));
CREATE TABLE IF NOT EXISTS user_foundation( user_id BIGINT REFERENCES users(user_id),foundation_id BIGINT REFERENCES foundations(foundation_id), CONSTRAINT PRIMARY KEY(foundation_id,user_id));
CREATE TABLE IF NOT EXISTS user_role(user_id BIGINT REFERENCES users(user_id), role_id INT REFERENCES roles(role_id), CONSTRAINT PRIMARY KEY(user_id,role_id));
CREATE TABLE IF NOT EXISTS events (event_id BIGINT AUTO_INCREMENT PRIMARY KEY, event_name varchar(100), event_date varchar(30), event_description varchar(200));
CREATE TABLE IF NOT EXISTS users_events(user_id BIGINT REFERENCES users(user_id), event_id INT REFERENCES events(event_id), CONSTRAINT PRIMARY KEY(user_id,event_id));
CREATE TABLE IF NOT EXISTS foundation_event( foundation_id BIGINT REFERENCES
 foundations(foundation_id), event_id BIGINT REFERENCES events(event_id),
 CONSTRAINT PRIMARY KEY(foundation_id,event_id));


INSERT INTO roles(role) VALUES("ROLE_VOLUNTEER"),("ROLE_FOUNDATION"), ("ROLE_ADMIN");
INSERT INTO types(type_name) values ("TYPE_FAMILY"), ("TYPE_PEACE"), ("TYPE_ENVIRONMENT"), ("TYPE_DISEASE"), ("TYPE_EDUCATION"), ("TYPE_CULTURE"), ("TYPE_ANIMALS"), ("TYPE_ADDICTION");


call util.trunctables('helpIT');

#Adrian

CREATE TABLE IF NOT EXISTS comments (id BIGINT PRIMARY KEY auto_increment, rate INT,content text, volunteer_volunteer_id INT references volunteers(volunteer_id), foundation_foundation_id BIGINT references foundations(foundation_id), create_timestamp timestamp, update_timestamp timestamp);
CREATE TABLE IF NOT EXISTS posts (id BIGINT PRIMARY KEY auto_increment, title text, content text, volunteer_volunteer_id INT references volunteers(volunteer_id), foundation_foundation_id BIGINT references foundations(foundation_id), create_timestamp timestamp, update_timestamp timestamp);
CREATE TABLE IF NOT EXISTS comments_under_posts (id BIGINT PRIMARY KEY auto_increment, content text, volunteer_volunteer_id INT references volunteers(volunteer_id), post_id BIGINT references posts(id), create_timestamp timestamp, update_timestamp timestamp);
drop database helpIT;

truncate addresses;
truncate events;
truncate foundation_event;
truncate foundation_types;
truncate foundations;
truncate foundations;
truncate roles;
truncate types;
truncate user_address;
truncate user_foundation;
truncate user_role;
truncate user_volunteer;
truncate users;
truncate users_events;
truncate volunteers;



